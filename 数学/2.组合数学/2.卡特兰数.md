# 卡特兰数 (Catalan)

卡特兰数是在组合数学中经常出现的一个数列，它并没有一个具体的意义，却是一个非常常见的数学规律。

## 一、定义

设$f_n$为卡特兰数的第n项。

1. **递归定义**：$f_n=f_0*f_{n-1}+f_1*f_{n-2}+...+f_{n-1}f_0$，其中$n\ge 2$。

2. **递推公式**：$f_n=\frac{4n-2}{n+1}f_{n-1}$。

3. **通项公式**：$f_n=\frac{1}{n+1}{2n\choose n}$。

   化简后可以得到：
   $$
   f_n={2n\choose n}-{2n\choose n-1}
   $$

4. 

只要求解的问题能够推导出上面的公式中的一个，就知道这是Catalan数。

> 个人对Catalan数的理解：
>
> 有一些操作 (比如进栈、出栈，连线、配对等)，这些操作有一些限制，如：
>
> + 一种操作数不能超过另一种操作数;
> + 两种操作不能有交集，等等。
>
> **这些操作的合法操作顺序的数量**。



## 二、实际问题

### 1. 合法路径个数

在一个$w\times h$的网格上，最开始在$(0, 0)$上，每个单位时间可以向上走一格，或者向右走一格，在任意时刻，向右走的次数不得小于向上走的次数，问走到$(n, m),0\le n$有多少种不同的合法路径。

**合法路径个数为$C_{2n}^n-C_{2n}^{n-1}$**。路径总数在$2n$次的移动中选n次向上移动，即$C_{2n}^n$。

画图可以发现，所有不合法路径一定会与$y=x+1$有一个交点，在交点之后将路径进行关于$y=x+1$的翻转操作，这些不合法路径都唯一对应着一条到$(n-1,n+1)$的路径，且所有到$(n-1,n+1)$的一条路径都唯一对应着一条不合法路径。

那么合法路径总数就是$C_{2n}^n-C_{2n}^{n-1}$。

> 接下来可以通过转化来将另为一些问题转化为与合法路径个数相同的问题。



### 2. 01序列

现在有n个0和n个1,问有多少个长度为2n的序列，使得序列的任意一个前缀中1的个数都大于等于0的个数。

显然，合法的序列个数为$C_{2n}^n-C_{2n}^{n-1}$。

**01序列是更本质的抽象**。

> 类似的具有01序列问题性质的还有括号匹配、进出栈问题。



### 3. 二叉树的构成问题

有n个点，问用这n个点可以构成多少不同的二叉树。

这也是卡特兰数问题，不过二叉树的构成使用的是卡特兰数的递归定义形式。

因为二叉树可以分成根节点，左子树，右子树，设i个点能够构成$f_i$个二叉树，枚举左右子树的节点数量即可得到如下公式：
$$
f_n=f_0*f_{n-1}+f_1*f_{n-2}+...+f_{n-1}*f_0
$$
这个和卡特兰数的递归定义一致。



### 4. 凸多边形的三角划分

一个凸的n边形，用直线连接它的两个顶点使之分成多个三角形，每条直线不能相交，问一共有多少种划分方法。

我们在凸多边形中随机挑选两个顶点连接一条边，这个凸多边形就会被划分成两个小多边形，由于每条直线不能相交，所以就转化为这两个小凸多边形的划分方案，然后相乘。

> 这个和二叉树的构成问题一样，我们枚举大凸多边形分成的两个小凸多边形打大小即可。





