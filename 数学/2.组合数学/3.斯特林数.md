# 斯特林数 (Stirling Number)

## 一、第二类斯特林数

第二类斯特林数也称为斯特林子集数，记做${n\brace m}$，也可记做$S(n,k)$，表示**将n个两两不同的元素，划分为k个互不相同的非空子集的方案数**。

1. **递推式**：
   $$
   {n\brace k}={n-1\brace k-1}+k{n-1\brace k}
   $$
   边界是${n\brace 0}=[n=0]$。

   可以使用组合意义来证明。

   插入一个新元素时，有两种方案：

   + 将新元素单独放入一个子集，有${n-1\brace k-1}$种方案。
   + 将新元素放入一个现有的非空子集，有$k{n-1\brace k}$种方案。

   根据加法原理，即可得到递推式。

2. **通项公式**：
   $$
   {n\brace m}=\sum_{i=0}^m\frac{(-1)^{m-i}i^n}{i!(m-i)!}
   $$
   可以使用容斥原理证明该公式。设将两两不同的元素，划分到k个两两不同的集合 (允许空集) 的方案数为$G_i$，将n个两两不同的元素，划分到k个两两不同的非空集合 (不允许空集) 的方案数为 $F_i$。

   显然：
   $$
   G_i=k^n\\
   G_i=\sum_{j=0}^i{i\choose j}F_j
   $$
   根据二项式反演：
   $$
   F_i=\sum_{j=0}^i(-1)^{i-j}{i\choose j}G_j\\
   =\sum_{j=0}^i(-1)^{i-j}{i\choose j}j^n\\
   =\sum_{j=0}^{i}\frac{i!(-1)^{i-j}j^n}{j!(i-j)!}
   $$
   考虑$F_i$与${n\brace i}$的关系。第二类斯特林数要求集合之间互不区分，因此，$F_i$正好就是${n\brace i}$的$i!$倍。于是：
   $$
   {n\brace m}=\frac{F_m}{m!}=\sum_{i=0}^m\frac{(-1)^mi^n}{i!(m-i)!}
   $$



## 二、第二类斯特林数的计算

对时间、空间要求不高的话，用动态规划求。

否则需要另外一些技巧。



## 三、第一类斯特林数

第一类斯特林数又称斯特林轮换数，通常记做${n\brack k}$，也可记做$s(n,k)$，表示**将n个两两不同的元素，划分为k个互不区分的非空轮换的方案数**。

> 一个轮换就是一个首尾相接的环形排列，两个可以通过旋转而互相得到的轮换是等价的。
>
> **一个轮换实际上可以对应一个圆排列**。
>
> 因此，**第一类斯特林数的另一种表达方式是n个两两不同的元素划分为k个互不区分的圆排列的方案数**。



1. **递推式**：
   $$
   {n\brack k}={n-1\brack k - 1}+(n-1){n-1\brack k}
   $$
   边界是${n\brack 0}=[n=0]$。

   通过组合意义进行递推式的证明。

   我们插入一个元素时，有两种方案：

   + 将新元素放在一个单独的轮换中，有${n-1\brack k - 1}$种方案。
   
   + 将该元素插入到任何一个现有的轮换中，共有$(n-1){n-1\brack k}$种方案。
   
     > 因为新的元素可以放在当前任意一个元素的后面构成一个新的轮换，所以乘的系数为$(n - 1)$。
   
   两者相加就可以得到递推式。

> 第一类斯特林数没有是实用的通项公式。



## 四、第一类斯特林数的计算

对时间、空间要求不高的话，可以使用动态规划来计算第一类斯特林数。

否则也是需要另外的技巧来优化计算第一类斯特林数。

