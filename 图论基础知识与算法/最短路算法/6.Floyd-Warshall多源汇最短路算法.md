# Floyd-Warshall多源汇最短路算法

## 一、Warshall算法

Warshall算法可以用于求传递闭包：存在一个有向图，可以用布尔邻接矩阵表示，能够给定图的顶点之间是否存在任意长度的有向路径，这种矩阵称为有向图的传递闭包，在常数时间内判断第j个顶点是否可以从第i个顶点到达，**即求解所有点对之间的连通性，使用邻接矩阵存储图**。

**==Warshall算法的本质是动态规划==**。

**设$p_{ij}^k$​表示$i$​节点和$j$​节点是否可以完全由$\{1,2,...,k\}$​​中节点联通**，节点$k$存在两种情况：

+ **节点$k$不在节点$i$到节点$j$的联通路径中**，那么$p_{ij}^k=p_{ij}^{k-1}$。
+ **节点$k$在节点$i$到节点$j$的联通路径中**，那么$p_{ij}^k=p_{ik}^{k-1}\or p_{kj}^{k-1}$。
+ 综上，$p_{ij}^k=p_{ij}^{k-1}\or p_{ik}^{k-1}\or p_{kj}^{k-1}$。



## 二、Floyd-Warshall算法

Floyd-Warshall算法在Warshall算法可以求解任意点对是否连通的基础上，计算任意点对之间的最短路。

设$p_{ij}^k$表示节点$i$和节点$j$用$\{1,2,..,k\}$中的节点连通的最短路径长度，节点$k$存在两种情况：

+ 节点$k$不在节点$i$到节点$j$的路径中，那么$p_{ij}^{k}=p_{ij}^{k-1}$。
+ 节点$k$在节点$i$到节点$j$的路径中，那么$p_{ij}^{k}=p_{ik}^{k-1}+p_{kj}^{k-1}$。
+ 综上，$p_{ij}^k=\min\{p_{ij}^{k-1},p_{ik}^{k-1}+p_{kj}^{k-1}\}$。

最终$p_{ij}^n$就表示节点$i$到节点$j$之间由$\{1,2,...,n\}$中节点连通的最短路长度，即最终的正确答案。

> 一般，最短路的计算可以分成如下步骤：**建图 + 计算最短路 + 得到最短路**。

